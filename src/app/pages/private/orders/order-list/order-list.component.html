<div class="flex flex-col md:flex-row items-center justify-between mb-4 gap-4">
  <div>
    <h2 class="!text-3xl font-bold text-black">Pedidos</h2>
    <p class="text-gray-500">Aqui você pode visualizar todos os pedidos realizados.</p>
  </div>
  <div class="flex gap-2 w-full md:w-auto">
    <input pInputText [(ngModel)]="search" type="text" placeholder="Buscar pedidos..." class="w-full md:w-64" />
    <p-button label="Novo Pedido" icon="pi pi-plus" [routerLink]="['novo']" />
  </div>
</div>

<div class="bg-white rounded-xl shadow-md p-8">
  <p-table
    [value]="filteredOrders"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[10, 20, 50]"
    [responsiveLayout]="'scroll'"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} pedidos"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Booster</th>
        <th>Serviço</th>
        <th>Status</th>
        <th>Início</th>
        <th>Término</th>
        <th>Valor Total</th>
        <th>Valor Booster</th>
        <th>Ações</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-order>
      <tr>
        <td class="text-sm">{{ order.booster }}</td>
        <td class="text-sm">{{ order.serviceType }}</td>
        <td class="text-sm">
          <span
            class="px-2 py-1 rounded-lg font-medium"
            [ngClass]="{
              'bg-yellow-100 text-yellow-800': order.status === 'Aguardando',
              'bg-blue-100 text-blue-800': order.status === 'Em andamento',
              'bg-green-100 text-green-800': order.status === 'Concluído',
            }"
          >
            {{ order.status }}
          </span>
        </td>
        <td class="text-sm">{{ order.startDate ? (order.startDate | date: 'dd/MM/yy':'':'pt-BR') : '-' }}</td>
        <td class="text-sm">{{ order.endDate ? (order.endDate | date: 'dd/MM/yy':'':'pt-BR') : '-' }}</td>
        <td class="text-sm">R$ {{ order.totalValue | number: '1.2-2' }}</td>
        <td class="text-sm">R$ {{ order.boosterValue | number: '1.2-2' }}</td>
        <td>
          <p-button icon="pi pi-pencil" [rounded]="true" [text]="true" severity="success" (click)="editOrder(order)" title="Editar" />
          <p-button icon="pi pi-trash" [rounded]="true" [text]="true" severity="danger" (click)="confirmDelete(order)" title="Excluir" />
        </td>
      </tr>
    </ng-template>
    <!-- Use o nome correto do slot -->
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="5" class="text-center text-gray-400 py-6">Nenhum pedido cadastrado.</td>
      </tr>
    </ng-template>
  </p-table>
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>
</div>

<!-- FORMULÁRIO DE NOVO PEDIDO (modal ou inline) -->
<app-order-form *ngIf="showOrderForm" (close)="closeOrderForm()" />
